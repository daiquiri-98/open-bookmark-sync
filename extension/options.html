<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Open Bookmark Sync - Settings</title>
    <style>
        :root {
            --control-h: 40px;
            --space-1: 8px;
            --space-2: 13px; /* ~8 * 1.618 */
            --space-3: 21px; /* ~13 * 1.618 */
            --space-4: 34px; /* ~21 * 1.618 */
            --border-soft: #edf0f5;
            --text: #2f3137;
            --text-muted: #666;
            --panel-bg: #ffffff;
            --header-h: 72px;
            --sidebar-w: 300px;
        }
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 16px;
            background-color: #f5f5f5;
            font-size: 14px;
            line-height: 1.55;
            color: var(--text);
        }

        .container {
            background: white;
            border-radius: 8px;
            padding: 24px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            width: 100%;
            margin: 0 auto;
            box-sizing: border-box;
        }

        h1 {
            color: var(--text);
            margin: 0 0 var(--space-2) 0;
            font-size: 22px;
            font-weight: 600;
        }

        h2 {
            color: var(--text);
            font-size: 16px;
            margin: var(--space-3) 0 var(--space-2) 0;
            font-weight: 600;
        }

        h3 {
            color: var(--text);
            font-size: 14px;
            margin: var(--space-2) 0 var(--space-1) 0;
            font-weight: 600;
        }

        .form-group {
            margin-bottom: 16px;
        }

        label {
            display: block;
            margin-bottom: 6px;
            font-weight: 500;
            color: var(--text);
        }

        input[type="text"],
        input[type="url"],
        input[type="password"],
        select {
            width: 100%;
            height: var(--control-h);
            padding: 0 10px;
            border: 1px solid #d7dbe2;
            border-radius: 4px;
            font-size: 14px;
            box-sizing: border-box;
        }

        /* Visually downgrade disabled controls */
        input:disabled,
        select:disabled,
        .toggle-eye:disabled {
            background-color: #f1f3f6 !important;
            color: #8a8f98 !important;
            border-color: #e6e9ef !important;
            opacity: 0.55;
            cursor: not-allowed;
        }

        /* Unify number inputs look */
        input[type="number"] {
            width: 100%;
            height: var(--control-h);
            padding: 0 10px;
            border: 1px solid #d7dbe2;
            border-radius: 4px;
            font-size: 14px;
            box-sizing: border-box;
            -moz-appearance: textfield;
        }
        input[type="number"]::-webkit-outer-spin-button,
        input[type="number"]::-webkit-inner-spin-button {
            -webkit-appearance: none;
            margin: 0;
        }

        input[type="text"]:focus,
        input[type="url"]:focus,
        input[type="password"]:focus,
        select:focus {
            outline: none;
            border-color: #5F7FFF;
            box-shadow: none;
        }

        .button {
            background-color: #007cba;
            color: white;
            border: none;
            height: var(--control-h);
            padding: 0 16px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            display: inline-flex; align-items: center; justify-content: center;
        }

        .button:hover {
            background-color: #005a87;
        }

        .button:disabled {
            background-color: #ccc;
            cursor: not-allowed;
        }

        .button.secondary {
            background-color: #6c757d;
        }

        .button.secondary:hover {
            background-color: #545b62;
        }

        .button.danger {
            background-color: #dc3545;
        }

        .button.danger:hover {
            background-color: #c82333;
        }

        .status {
            padding: 12px;
            border-radius: 4px;
            margin: 16px 0;
            font-weight: 500;
        }

        .status.success {
            background-color: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }

        .status.error {
            background-color: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }

        .status.info {
            background-color: #d1ecf1;
            color: #0c5460;
            border: 1px solid #bee5eb;
        }

        .help-text { font-size: 13px; color: var(--text-muted); margin-top: 4px; }

        .sections-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(380px, 1fr)); gap: 15px; align-items: start; }
        .section { border: 1px solid var(--border-soft); border-radius: 10px; padding: 18px; margin: 0; background: var(--panel-bg); }

        .auth-status {
            display: flex;
            align-items: center;
            gap: 12px;
            margin: 12px 0;
        }

        .status-indicator {
            width: 12px;
            height: 12px;
            border-radius: 50%;
        }

        .status-indicator.connected {
            background-color: #28a745;
        }

        .status-indicator.disconnected {
            background-color: #dc3545;
        }

        .sync-info {
            font-size: 14px;
            color: #666;
            margin-top: 8px;
        }

        .pre-filled {
            background-color: #f8f9fa;
            color: #495057;
        }

        .hidden {
            display: none;
        }

        .input-row { display:grid; grid-template-columns: 1fr auto; gap:8px; align-items:center; }

        .toggle-eye { background:#eef2f7; color:#333; border:1px solid #e3e7ef; border-radius:4px; height: var(--control-h); padding:0 12px; cursor:pointer; font-size:13px; min-width:64px; display:inline-flex; align-items:center; justify-content:center; }

        .support {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .bmc-link { background-color: #FFDD00; color: #111; border: none; border-radius: 6px; padding: 8px 12px; font-weight: 600; text-decoration: none; display: inline-flex; align-items: center; gap: 6px; }
        .bmc-link:hover { filter: brightness(0.95); }

        /* Floating support button (MV3-safe replacement for BMC widget) */
        .bmc-float {
            position: fixed;
            right: 18px;
            bottom: 18px;
            z-index: 1000;
            background-color: #5F7FFF;
            color: #fff;
            border: none;
            border-radius: 28px;
            padding: 10px 14px;
            font-weight: 600;
            text-decoration: none;
            box-shadow: 0 4px 12px rgba(0,0,0,0.2);
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }
        .bmc-float:hover { filter: brightness(0.95); }

        /* Tabbed layout */
        .tabs { display: flex; gap: 8px; border-bottom: 1px solid #eee; margin-bottom: 0; }
        .tab-btn { background:#f5f7fb; border:1px solid #e3e7ef; border-bottom:none; padding:8px 12px; border-top-left-radius:6px; border-top-right-radius:6px; cursor:pointer; font-weight:600; color:#333; }
        .tab-btn.active { background:#ffffff; color:#111; }
        .tab-btn.danger { background:#dc3545; color:white; border-color:#dc3545; }
        .tab-btn.danger.active { background:#c82333; color:white; }
        .tab-content { border:none; border-radius: 0; background: transparent; }
        .tab-panel { display:none; padding:0; }
        .tab-panel.active { display:block; }

        .sections-grid { display:block; }
        .section { border:1px solid var(--border-soft); border-radius:10px; padding:18px; margin:12px 0; background:#fff; }

        /* Inline row for select + button alignment */
        .inline-row { display:grid; grid-template-columns: 1fr auto; gap:8px; align-items:center; }
        .inline-row select { height: var(--control-h); }
        .inline-row .button { height: var(--control-h); padding: 0 12px; display:inline-flex; align-items:center; }

        /* Collections controls layout */
        .collections-controls {
            display: grid;
            grid-template-columns: 1fr auto auto;
            gap: 8px;
            align-items: center;
            margin: 8px 0;
        }

        .refresh-section {
            margin: 8px 0;
        }

        .danger-section { margin: 16px 0; padding: 16px; border: 1px solid #dc3545; border-radius: 10px; background-color: #f8d7da; }
        .collections-controls input {
            height: var(--control-h);
            padding: 0 10px;
            border: 1px solid #d7dbe2;
            border-radius: 4px;
            font-size: 14px;
            box-sizing: border-box;
        }

        .sync-settings-container.disabled {
            opacity: 0.5;
            pointer-events: none;
        }

        /* Checkbox row layout */
        .checkbox-row {
            display: flex;
            align-items: center;
            gap: 16px;
            margin: 8px 0;
            flex-wrap: wrap;
        }
        .checkbox-label {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        /* Grid layouts */
        .sync-settings-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 20px;
        }


        /* Collections styling */
        .collections-select {
            min-width: 280px;
            display: none;
        }
        .collections-list {
            border: 1px solid #d7dbe2;
            border-radius: 4px;
            padding: 8px;
            max-height: 240px;
            overflow: auto;
            background: #fff;
        }

        /* Hierarchical collection styling */
        .collection-item {
            display: flex;
            align-items: center;
            gap: 6px;
            padding: 4px 6px;
            margin: 2px 0;
        }
        .collection-item.child {
            margin-left: 20px;
        }
        .collection-item.grandchild {
            margin-left: 40px;
        }
        .collection-checkbox {
            min-width: 16px;
        }
        .collection-checkbox.indeterminate {
            opacity: 0.7;
        }
        .collection-label {
            flex: 1;
            user-select: none;
            cursor: pointer;
        }

        /* Expand/collapse button styling */
        .expand-button {
            width: 16px;
            height: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 10px;
            color: #666;
            border-radius: 2px;
            transition: all 0.2s ease;
        }
        .expand-button:hover {
            background-color: #f0f0f0;
            color: #333;
        }
        .expand-spacer {
            width: 16px;
            height: 16px;
        }

        /* Sidebar layout (alternative theme) */
        .main { display: block; }
        .sidebar { display: none; }
        .main-content { width: 100%; }

        body.layout-sidebar { padding: 0; background: #f0f2f5; }
        body.layout-sidebar .container {
            max-width: none;
            margin: 0;
            border-radius: 0;
            box-shadow: none;
            padding: 0;
            min-height: 100vh;
            /* push content below fixed header */
            padding-top: var(--header-h);
        }
        body.layout-sidebar .header {
            padding: 12px 20px;
            border-bottom: 1px solid #e9ecef;
            background: #fff;
            display:flex; align-items:center; justify-content: space-between;
            position: fixed; top: 0; left: 0; right: 0; z-index: 200;
            height: var(--header-h);
            box-sizing: border-box;
        }
        body.layout-sidebar .main { display: block; }
        body.layout-sidebar .sidebar {
            display: block;
            width: var(--sidebar-w);
            background: #ffffff;
            border-right: 1px solid #e9ecef;
            padding: 24px 16px; /* restore comfortable inner padding */
            box-sizing: border-box; /* keep total width equal to --sidebar-w */
            position: fixed; top: var(--header-h); left: 0; bottom: 0;
            overflow-y: auto; /* scrolls within available viewport */
        }
        body.layout-sidebar .main-content {
            margin-left: var(--sidebar-w);
            width: calc(100% - var(--sidebar-w)); /* prevent horizontal overflow */
            margin-top: 0; /* flush with header */
            min-width: 0;
            padding: 24px 28px; /* restore breathing room */
            background: #f7f8fb;
            overflow: auto; /* scrolls content, keeps header & sidebar fixed */
            overflow-x: hidden; /* guard against tiny rounding overflow */
            box-sizing: border-box;
            height: calc(100vh - var(--header-h));
        }
        body.layout-sidebar .tabs { display: none; }
        body.layout-sidebar .tab-content .section { margin: 0 0 12px 0; }

        .sidebar-section { margin-bottom: 16px; }
        .sidebar-title { font-size: 12px; font-weight: 600; color: #2f3137; text-transform: uppercase; padding: 8px 10px; }
        .side-link {
            width: 100%;
            text-align: left;
            background: transparent;
            border: none;
            padding: 8px 10px;
            border-radius: 6px;
            cursor: pointer;
            color: #7a828c; /* slightly more muted for inactive */
            font-weight: 400;
            display: block;
        }
        .side-link:hover { background: #f1f3f5; }
        .side-link.active { background: #eef2f7; color: #2f3137; }
        .side-link.danger.active, .side-link.danger { color: #dc3545; }

        /* Softer placeholders */
        input::placeholder,
        textarea::placeholder {
            color: #9aa0a6;
            opacity: 1;
        }

        /* Children container styling */
        .collection-children {
            transition: all 0.3s ease;
        }
        .collection-children[style*="display: none"] {
            opacity: 0;
            max-height: 0;
            overflow: hidden;
        }

        .button.small {
            padding: 0 16px;
            font-size: 12px;
            white-space: nowrap;
        }

        .support-text { font-size: 14px; color: #444; line-height: 1.6; }

        /* Support page styling */
        .support-section {
            margin: 24px 0;
            padding: 16px 0;
            border-bottom: 1px solid #eee;
        }
        .support-section:last-child {
            border-bottom: none;
        }
        .support-section h3 {
            margin: 0 0 16px 0;
            font-size: 16px;
            color: #333;
        }
        .support-buttons {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
            justify-content: flex-start;
        }

        /* Header actions */
        .header { display:flex; align-items:center; justify-content: space-between; }
        .header-actions { display:flex; align-items:center; gap:8px; }
        .header-link {
            display: flex;
            align-items: center;
            gap: 6px;
            padding: 8px 12px;
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 6px;
            text-decoration: none;
            color: #333;
            font-weight: 500;
            font-size: 13px;
            transition: all 0.2s ease;
        }
        .header-link:hover {
            background: #e9ecef;
            border-color: #dee2e6;
            transform: translateY(-1px);
        }
        .header-link.primary {
            background: #007cba;
            border-color: #006ba3;
            color: white;
        }
        .header-link.primary:hover {
            background: #006ba3;
            border-color: #005a87;
        }
    </style>
</head>
<body class="layout-sidebar">
    <div class="container">
        <div class="header">
            <h1>Open Bookmark Sync</h1>
            <div class="header-actions">
                <a id="siteLink" class="header-link" href="#" target="_blank" rel="noopener noreferrer">
                    <span>üè†</span>
                    <span>Visit Website</span>
                </a>
                <a href="mailto:dagkan@daiquiri.dev?subject=Raindrop%20Browser%20Sync%20-%20Issue%20Report&body=Hi%2C%0A%0AI%20found%20an%20issue%20with%20the%20Raindrop%20Browser%20Sync%20extension%3A%0A%0A%5BPlease%20describe%20the%20issue%20here%5D%0A%0AThanks%21" class="header-link">
                    <span>üìß</span>
                    <span>Report Issues</span>
                </a>
                <a id="bmcLink" class="bmc-link" href="https://buymeacoffee.com/daiquiri" target="_blank" rel="noopener noreferrer">
                    <span>‚òï</span>
                    <span>Buy me a coffee</span>
                </a>
            </div>
        </div>

        

        <div class="main">
            <nav class="sidebar" aria-label="Sidebar Navigation">
                <div class="sidebar-section">
                    <div class="sidebar-title">Raindrop</div>
                    <button class="side-link" data-tab="api">Connection</button>
                    <button class="side-link" data-tab="sync">Sync</button>
                </div>
                <div class="sidebar-section">
                    <div class="sidebar-title">Maintenance</div>
                    <button class="side-link" data-tab="import">Import/Export</button>
                    <button class="side-link danger" data-tab="danger">‚ö†Ô∏è Danger Zone</button>
                </div>
                <div class="sidebar-section">
                    <div class="sidebar-title">Resources</div>
                    <button class="side-link" data-tab="support">Get Help</button>
                    <button class="side-link" data-tab="roadmap">Roadmap</button>
                    <button class="side-link" data-tab="bmc">Buy Me a Coffee</button>
                </div>
            </nav>
            <div class="main-content">
                <div class="tab-content">
        <div id="statusMessage" class="status hidden" style="position: sticky; top: 0; z-index: 5; margin: 0 0 10px 0;"></div>
        <div class="section tab-panel active" id="tab-api" data-tab="api">
            <h2>Raindrop.io API Configuration</h2>

            <div class="form-group">
                <label class="checkbox-label" style="gap:8px; align-items:center; display:flex;">
                    <input type="checkbox" id="managedOAuth"> Use Managed OAuth via Cloudflare
                </label>
                <div class="help-text">When enabled, the extension delegates OAuth to your Cloudflare Worker.</div>
            </div>

            <div class="form-group" id="managedBaseGroup" style="display:block;">
                <label for="managedOAuthBaseUrl">Managed OAuth Base URL</label>
                <div class="input-row">
                    <input type="url" id="managedOAuthBaseUrl" placeholder="https://login-with-raindrop.hello-a71.workers.dev" class="pre-filled" disabled>
                    <button id="managedBaseEdit" type="button" class="toggle-eye" aria-label="Edit base URL">Edit</button>
                </div>
                <div class="help-text">Default is locked. Click Edit for manual override (beta/testing).</div>
            </div>

            <div class="form-group">
                <label for="clientId">Client ID</label>
                <div class="input-row">
                    <input type="password" id="clientId" placeholder="Enter your Raindrop Client ID">
                    <button id="toggleClientId" type="button" class="toggle-eye" aria-label="Show/Hide">Show</button>
                </div>
                <div class="help-text">Stored locally via Chrome storage. Hidden by default for privacy.</div>
            </div>

            <div class="form-group">
                <label for="clientSecret">Client Secret</label>
                <div class="input-row">
                    <input type="password" id="clientSecret" placeholder="Enter your Raindrop Client Secret">
                    <button id="toggleClientSecret" type="button" class="toggle-eye" aria-label="Show/Hide">Show</button>
                </div>
                <div class="help-text">Do not share your client secret.</div>
            </div>

            <div class="form-group">
                <label for="redirectUri">Redirect URI</label>
                <input type="url" id="redirectUri" class="pre-filled" placeholder="Extension identity redirect (auto)">
                <div class="help-text">Default is the extension identity URL (auto). You can override this for beta testing; ensure it matches what you registered in Raindrop.</div>
            </div>

            <button id="saveConfig" class="button">Save Configuration</button>

            <h2>Authentication</h2>
            <div class="auth-status">
                <div id="statusIndicator" class="status-indicator disconnected"></div>
                <span id="authStatusText">Not authenticated</span>
            </div>
            <button id="authenticate" class="button">Authenticate with Raindrop.io</button>
            <button id="testConnection" class="button secondary">Test Connection</button>
            <button id="logout" class="button danger hidden">Logout</button>
            <div id="userInfo" class="sync-info hidden"></div>
        </div>

        <div class="section tab-panel" id="tab-sync" data-tab="sync">
            <h2>Sync Settings</h2>

            <div class="form-group">
                <div class="checkbox-row">
                    <label class="checkbox-label">
                        <input type="checkbox" id="syncEnabled" checked>
                        <strong>Enable Raindrop Sync</strong>
                    </label>
                </div>
                <div class="help-text">When disabled, automatic sync stops and manual sync is blocked.</div>
            </div>

            <div id="syncSettings" class="sync-settings-container">
                <div class="sync-info" style="margin-bottom:12px;">
                    <div id="autoSyncInfo">Automatic sync: Every 5 minutes</div>
                    <div id="lastSyncTime">Last sync: Never</div>
                </div>

            <div class="sync-settings-grid">
                <div class="form-group">
                    <label for="syncInterval">Sync interval (minutes)</label>
                    <input type="number" id="syncInterval" min="1" step="1" placeholder="5">
                    <div class="help-text">Minimum 1 minute. Alarm is rescheduled automatically.</div>
                </div>

                <div class="form-group">
                    <label for="rateLimitRpm">Max requests per minute</label>
                    <input type="number" id="rateLimitRpm" min="1" step="1" placeholder="60">
                    <div class="help-text">Used to pace API calls and avoid rate limit (429). Backoff applies automatically.</div>
                </div>
            </div>

            <div class="form-group">
                <label for="syncModeSelect">Sync mode</label>
                <select id="syncModeSelect">
                    <option value="additions_only">Two-way: Additions only</option>
                    <option value="mirror">Two-way: Mirror (add/update/delete)</option>
                    <option value="upload_only">One-way: Browser ‚Üí Raindrop (additions only)</option>
                    <option value="off">One-way: Raindrop ‚Üí Browser (rebuild)</option>
                </select>
                <div class="help-text">Controls direction and level of reconciliation.</div>
            </div>

            <div class="form-group collections-block">
                <label>Collections to import</label>
                <div class="help-text">Choose which Raindrop collections to import.</div>
                <div class="checkbox-row">
                    <label class="checkbox-label"><input type="checkbox" id="topLevelOnly" checked> Top-level only (recommended)</label>
                </div>
                <div class="refresh-section">
                    <button id="refreshCollections" class="button secondary" type="button">Refresh Collections & Folders</button>
                </div>
                <div class="collections-controls">
                    <input type="text" id="collectionsSearch" placeholder="Search collections" />
                    <button id="selectAllCollections" class="button secondary small" type="button">Select all</button>
                    <button id="clearCollections" class="button secondary small" type="button">Clear</button>
                </div>
                <div id="collectionsList" class="collections-list"></div>
                <div class="help-text">Select specific collections to import. Only available when "Top-level only" is disabled.</div>
            </div>

            <div class="form-group">
                <label for="targetFolderSelect">Target bookmarks folder</label>
                <select id="targetFolderSelect"></select>
                <div class="help-text">Items sync directly under the selected folder (default: Bookmarks Bar).</div>
            </div>

            <h2>Sorting Options</h2>

            <div class="form-group">
                <label for="collectionsSortSelect">Collections order</label>
                <select id="collectionsSortSelect">
                    <option value="alpha_asc">Alphabetical (A ‚Üí Z)</option>
                    <option value="alpha_desc">Alphabetical (Z ‚Üí A)</option>
                    <option value="raindrop">Raindrop order (if available)</option>
                    <option value="none">Do not reorder</option>
                </select>
                <div class="help-text">Applies to collection folders at the target root.</div>
            </div>

            <div class="form-group">
                <label for="bookmarksSortSelect">Bookmarks order</label>
                <select id="bookmarksSortSelect">
                    <option value="created_desc">Newest first</option>
                    <option value="created_asc">Oldest first</option>
                    <option value="alpha_asc">Alphabetical (A ‚Üí Z)</option>
                    <option value="alpha_desc">Alphabetical (Z ‚Üí A)</option>
                    <option value="domain_asc">Domain (A ‚Üí Z)</option>
                    <option value="none">Do not reorder</option>
                </select>
                <div class="help-text">Applies to bookmarks inside each collection folder.</div>
            </div>

            <div class="form-group" style="margin-top: 12px;">
                <button id="syncNow" class="button">Sync Now</button>
            </div>
            </div> <!-- end syncSettings container -->
        </div>

        <div class="section tab-panel" id="tab-import" data-tab="import">
            <h2>Import & Export</h2>

            <div class="form-group">
                <h3>Export Bookmarks</h3>
                <div style="margin: 12px 0;">
                    <button id="exportBookmarks" class="button secondary" type="button">Export All Bookmarks (JSON)</button>
                    <div class="help-text">Downloads all your bookmarks as a JSON file for backup or transfer.</div>
                </div>
            </div>

            <div class="form-group">
                <h3>Import Bookmarks</h3>
                <div style="margin: 12px 0;">
                    <input type="file" id="importFile" accept=".json,.html,.htm" style="margin-bottom: 8px;" />
                    <button id="importBookmarks" class="button secondary" type="button" disabled>Import Bookmarks</button>
                    <div class="help-text">
                        Supports:
                        <ul style="margin: 8px 0; padding-left: 20px;">
                            <li><strong>JSON:</strong> Chrome/Brave bookmark exports or our backup format</li>
                            <li><strong>HTML:</strong> Standard browser bookmark exports</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>

        <div class="section tab-panel" id="tab-support" data-tab="support">
            <h2>Guide & Help</h2>
            <p class="support-text">Quick how-to and where to get help or share feedback.</p>

            <div class="sections-grid">
                <div class="section">
                    <h3>1) Connect Raindrop.io</h3>
                    <p>Open the Raindrop section and enter your Client ID/Secret, then Authenticate. Use Test Connection to verify.</p>
                </div>
                <div class="section">
                    <h3>2) Choose Sync Mode</h3>
                    <p>Pick the reconciliation level (e.g., Additions only or Mirror) and set the sync interval and rate limit for safety.</p>
                </div>
                <div class="section">
                    <h3>3) Collections & Target</h3>
                    <p>Select which collections to import, and where in the browser bookmarks they should appear.</p>
                </div>
                <div class="section">
                    <h3>Good To Know</h3>
                    <ul>
                        <li>Manual ‚ÄúSync Now‚Äù runs immediately.</li>
                        <li>Disable sync before clearing all bookmarks to avoid auto-restore.</li>
                        <li>Export a JSON backup for safety before big changes.</li>
                    </ul>
                </div>
            </div>

            <div class="support-section">
                <h3>Get Help</h3>
                <div class="support-buttons">
                    <a id="supportPanelSite" class="header-link" href="#" target="_blank" rel="noopener noreferrer">
                        <span>üè†</span>
                        <span>Visit Website</span>
                    </a>
                    <a href="mailto:dagkan@daiquiri.dev?subject=Raindrop%20Browser%20Sync%20-%20Issue%20Report&body=Hi%2C%0A%0AI%20found%20an%20issue%20with%20the%20Raindrop%20Browser%20Sync%20extension%3A%0A%0A%5BPlease%20describe%20the%20issue%20here%5D%0A%0AThanks%21" class="header-link">
                        <span>üìß</span>
                        <span>Report Issues</span>
                    </a>
                </div>
            </div>
        </div>

        <div class="section tab-panel" id="tab-roadmap" data-tab="roadmap">
            <h2>Roadmap</h2>
            <p class="help-text">Planned improvements focusing on safety, clarity, and scalability.</p>

            <div class="sections-grid">
                <div class="section">
                    <h3>Safer Sync</h3>
                    <ul>
                        <li>Dry‚ÄëRun / Preview before applying changes</li>
                        <li>‚ÄúNo‚ÄëDelete‚Äù Safe Mode (Mirror without deletions)</li>
                        <li>Automatic snapshot + Undo last sync</li>
                    </ul>
                </div>
                <div class="section">
                    <h3>Per‚ÄëCollection Controls</h3>
                    <ul>
                        <li>Enable/disable per collection</li>
                        <li>Collection ‚Üí target folder mapping</li>
                        <li>Include/exclude by tag or domain</li>
                    </ul>
                </div>
                <div class="section">
                    <h3>Scheduling & Resilience</h3>
                    <ul>
                        <li>Quiet hours and conditional pauses</li>
                        <li>Next sync ETA + quick retry</li>
                    </ul>
                </div>
                <div class="section">
                    <h3>Cloud Backends</h3>
                    <ul>
                        <li>Amazon S3, Cloudflare R2</li>
                        <li>Google Drive, OneDrive, Dropbox</li>
                    </ul>
                </div>
            </div>

            <div class="support-section">
                <a class="header-link" href="#" id="openRoadmapRepo" target="_blank" rel="noopener noreferrer">üìÑ View full ROADMAP.md</a>
            </div>
        </div>

        <div class="section tab-panel" id="tab-bmc" data-tab="bmc">
            <h2>Buy Me a Coffee ‚òï</h2>
            <p class="support-text">If this extension saves you time, a coffee helps me keep improving it. Thank you for your support!</p>
            <div class="support-section">
                <div class="support-buttons">
                    <a id="bmcPanelLink" class="bmc-link" href="https://buymeacoffee.com/daiquiri" target="_blank" rel="noopener noreferrer">
                        <span>‚òï</span>
                        <span>Buy me a coffee</span>
                    </a>
                </div>
            </div>
        </div>

        <div class="section tab-panel" id="tab-danger" data-tab="danger">
            <h2 style="color: #dc3545;">‚ö†Ô∏è Danger Zone</h2>
            <p style="color: #721c24; font-weight: 500; margin-bottom: 24px;">
                These operations are destructive and cannot be undone. Use with extreme caution!
            </p>

            <div class="danger-section">
                <h3 style="color: #dc3545; margin: 16px 0 8px 0;">Browser Cleanup</h3>
                <div style="margin: 12px 0;">
                    <button id="cleanupDuplicates" class="button danger" type="button">Remove Duplicate Bookmarks</button>
                    <div class="help-text" style="color: #721c24; margin-top: 4px;">Removes duplicate bookmarks in browser only (no Raindrop changes).</div>
                </div>
            </div>

            <div class="danger-section">
                <h3 style="color: #dc3545; margin: 16px 0 8px 0;">Nuclear Option</h3>
                <div style="margin: 12px 0;">
                    <button id="clearAllBookmarks" class="button danger" type="button">Clear ALL Bookmarks</button>
                    <div class="help-text" style="color: #721c24; margin-top: 4px;">‚ö†Ô∏è WARNING: This will delete ALL bookmarks in your browser! Backup required before execution.</div>
                </div>
                <div id="clearConfirmation" class="confirmation-section" style="display: none; margin-top: 12px; padding: 16px; background: #f5f5f5; border: 1px solid #dc3545; border-radius: 4px;">
                    <div id="clearSyncWarning" class="status info" style="display:none; margin-top:0;">
                        Raindrop Sync is currently enabled. After clearing, bookmarks may be restored from Raindrop automatically. Consider disabling "Enable Raindrop Sync" above before proceeding.
                    </div>
                    <div style="margin-bottom: 16px;">
                        <div style="font-weight: bold; color: #721c24; margin-bottom: 8px;">üì• Step 1: Download Backup</div>
                        <button id="downloadBackup" class="button secondary" type="button">Download Bookmarks Backup</button>
                    </div>
                    <div style="margin-bottom: 16px;">
                        <div style="font-weight: bold; color: #721c24; margin-bottom: 8px;">‚ö†Ô∏è Step 2: Confirm Deletion</div>
                        <div style="margin-bottom: 6px; color: #721c24;">Type "CLEAR ALL" to confirm:</div>
                        <input type="text" id="clearConfirmText" placeholder="Type CLEAR ALL here" style="width: 100%; padding: 8px; margin-bottom: 8px; box-sizing: border-box;" />
                    </div>
                    <div style="display: flex; gap: 8px;">
                        <button id="executeClear" class="button danger" disabled>Execute Clear</button>
                        <button id="cancelClear" class="button secondary">Cancel</button>
                    </div>
                </div>
            </div>
        </div>
        </div> <!-- end tab-content -->
            </div> <!-- end main-content -->
        </div> <!-- end main -->
    </div>

    <script src="oauth.js"></script>
    <script src="options.js"></script>
</body>
</html>
